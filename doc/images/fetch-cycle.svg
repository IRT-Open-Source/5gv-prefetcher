<svg id="mermaid-1603714126932" width="100%" xmlns="http://www.w3.org/2000/svg" height="1391" style="max-width: 1048.5px;" viewBox="-50 -10 1048.5 1391"><style>#mermaid-1603714126932{font-family:"trebuchet ms",verdana,arial;font-size:16px;fill:#333;}#mermaid-1603714126932 .error-icon{fill:#552222;}#mermaid-1603714126932 .error-text{fill:#552222;stroke:#552222;}#mermaid-1603714126932 .edge-thickness-normal{stroke-width:2px;}#mermaid-1603714126932 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1603714126932 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1603714126932 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1603714126932 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1603714126932 .marker{fill:#333333;}#mermaid-1603714126932 .marker.cross{stroke:#333333;}#mermaid-1603714126932 svg{font-family:"trebuchet ms",verdana,arial;font-size:16px;}#mermaid-1603714126932 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1603714126932 text.actor &gt; tspan{fill:black;stroke:none;}#mermaid-1603714126932 .actor-line{stroke:grey;}#mermaid-1603714126932 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1603714126932 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1603714126932 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1603714126932 .sequenceNumber{fill:white;}#mermaid-1603714126932 #sequencenumber{fill:#333;}#mermaid-1603714126932 #crosshead path{fill:#333;stroke:#333;}#mermaid-1603714126932 .messageText{fill:#333;stroke:#333;}#mermaid-1603714126932 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1603714126932 .labelText,#mermaid-1603714126932 .labelText &gt; tspan{fill:black;stroke:none;}#mermaid-1603714126932 .loopText,#mermaid-1603714126932 .loopText &gt; tspan{fill:black;stroke:none;}#mermaid-1603714126932 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%);}#mermaid-1603714126932 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1603714126932 .noteText,#mermaid-1603714126932 .noteText &gt; tspan{fill:black;stroke:none;}#mermaid-1603714126932 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1603714126932 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1603714126932 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1603714126932:root{--mermaid-font-family:"trebuchet ms",verdana,arial;}#mermaid-1603714126932 sequence{fill:apa;}</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="1380" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">Core Logic</tspan></text></g><g><line id="actor1" x1="367" y1="5" x2="367" y2="1380" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="292" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="367" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="367" dy="0">Request List</tspan></text></g><g><line id="actor2" x1="634" y1="5" x2="634" y2="1380" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="559" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="634" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="634" dy="0">Black List</tspan></text></g><g><line id="actor3" x1="873.5" y1="5" x2="873.5" y2="1380" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="798.5" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="873.5" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="873.5" dy="0">HTTP Client</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><g><rect x="50" y="75" fill="#EDF2AE" stroke="#666" width="848.5" height="52" rx="0" ry="0" class="note"></rect><text x="474" y="80" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="noteText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 14px; font-weight: 400;"><tspan x="474">Precondition: Core Logic has been informed by message </tspan></text><text x="474" y="96" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="noteText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 14px; font-weight: 400;"><tspan x="474">streamer of new aggregator configuration and cache state</tspan></text></g><text x="474" y="187" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">GET: missing media </text><text x="474" y="204" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">items from State API</text><line x1="75" y1="233" x2="873.5" y2="233" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><g><rect x="868.5" y="233" fill="#EDF2AE" stroke="#666" width="10" height="44" rx="0" ry="0" class="activation0"></rect></g><text x="472" y="248" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">missing media items</text><line x1="868.5" y1="277" x2="75" y2="277" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="221" y="292" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Create Request List from URLs</text><text x="221" y="309" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"> of missing media items</text><line x1="75" y1="338" x2="367" y2="338" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><g><rect x="362" y="338" fill="#EDF2AE" stroke="#666" width="10" height="206" rx="0" ry="0" class="activation0"></rect></g><text x="503" y="353" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">get black listed media items</text><line x1="372" y1="382" x2="634" y2="382" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><g><rect x="629" y="384" fill="#EDF2AE" stroke="#666" width="10" height="42" rx="0" ry="0" class="activation0"></rect></g><text x="501" y="397" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">black listed media items</text><line x1="629" y1="426" x2="372" y2="426" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="372" y="441" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Remove black listed media items from list</text><path d="M 372,470 C 432,460 432,500 372,490" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></path><text x="219" y="515" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">created</text><line x1="362" y1="544" x2="75" y2="544" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="221" y="604" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">execute next request</text><line x1="75" y1="633" x2="367" y2="633" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><g></g><text x="623" y="648" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">GET: media item URLs</text><line x1="372" y1="677" x2="873.5" y2="677" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><g><rect x="868.5" y="679" fill="#EDF2AE" stroke="#666" width="10" height="42" rx="0" ry="0" class="activation0"></rect></g><text x="620" y="692" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Response status</text><line x1="868.5" y1="721" x2="372" y2="721" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="372" y="781" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Remove request</text><path d="M 372,810 C 432,800 432,840 372,830" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></path><text x="372" y="900" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Remove request</text><path d="M 372,929 C 432,919 432,959 372,949" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></path><text x="503" y="974" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Add media item to black list</text><line x1="372" y1="1003" x2="634" y2="1003" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="372" y="1077" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Remove request</text><path d="M 372,1106 C 432,1096 432,1136 372,1126" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></path><text x="372" y="1176" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">Keep request</text><path d="M 372,1205 C 432,1195 432,1235 372,1225" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></path><g><line x1="287" y1="731" x2="644" y2="731" class="loopLine"></line><line x1="644" y1="731" x2="644" y2="1275" class="loopLine"></line><line x1="287" y1="1275" x2="644" y2="1275" class="loopLine"></line><line x1="287" y1="731" x2="287" y2="1275" class="loopLine"></line><line x1="287" y1="855" x2="644" y2="855" class="loopLine" style="stroke-dasharray: 3, 3;"></line><line x1="287" y1="1018" x2="644" y2="1018" class="loopLine" style="stroke-dasharray: 3, 3;"></line><line x1="287" y1="1151" x2="644" y2="1151" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="287,731 337,731 337,744 328.6,751 287,751" class="labelBox"></polygon><text x="312" y="744" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">alt</text><text x="490.5" y="749" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="490.5">[status code indicates success]</tspan></text><text x="465.5" y="873" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">[forbidden status code]</text><text x="465.5" y="1036" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">[count of status code exceeds allowed</text><text x="465.5" y="1053" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">occurrences]</text></g><g><line x1="65" y1="554" x2="888.5" y2="554" class="loopLine"></line><line x1="888.5" y1="554" x2="888.5" y2="1285" class="loopLine"></line><line x1="65" y1="1285" x2="888.5" y2="1285" class="loopLine"></line><line x1="65" y1="554" x2="65" y2="1285" class="loopLine"></line><polygon points="65,554 115,554 115,567 106.6,574 65,574" class="labelBox"></polygon><text x="90" y="567" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">loop</text><text x="501.75" y="572" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="501.75">[while Request List has requests]</tspan></text></g><g><line x1="55" y1="137" x2="898.5" y2="137" class="loopLine"></line><line x1="898.5" y1="137" x2="898.5" y2="1295" class="loopLine"></line><line x1="55" y1="1295" x2="898.5" y2="1295" class="loopLine"></line><line x1="55" y1="137" x2="55" y2="1295" class="loopLine"></line><polygon points="55,137 105,137 105,150 96.6,157 55,157" class="labelBox"></polygon><text x="80" y="150" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">loop</text><text x="501.75" y="155" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="501.75">[while HTTP Client returns missing media items]</tspan></text></g><g><rect x="0" y="1315" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="1347.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">Core Logic</tspan></text></g><g><rect x="292" y="1315" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="367" y="1347.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="367" dy="0">Request List</tspan></text></g><g><rect x="559" y="1315" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="634" y="1347.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="634" dy="0">Black List</tspan></text></g><g><rect x="798.5" y="1315" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="873.5" y="1347.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="873.5" dy="0">HTTP Client</tspan></text></g></svg>